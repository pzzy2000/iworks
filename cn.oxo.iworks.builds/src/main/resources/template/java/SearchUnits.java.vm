package  ${BuildDaoBean.basePath}.service.units;

import java.util.List ;
import org.apache.commons.lang3.StringUtils;

import org.springframework.stereotype.Component ;
import org.springframework.beans.factory.annotation.Autowired;
import cn.zy.dev.tools.ex.SystemOptServiceException;
import cn.zy.dev.tools.units.CommSearchBean;
import cn.zy.dev.tools.units.SQLUilts.OptType;
import cn.zy.dev.tools.units.SelectPage;
import com.baomidou.mybatisplus.extension.plugins.pagination.Page;
import ${BuildDaoBean.clazz.getName()};

import ${BuildDaoBean.basePath}.pojo.bean.${BuildDaoBean.className}SearchBean;
import ${BuildDaoBean.basePath}.service.mybatis.${BuildDaoBean.className}BaseMapper;
import com.zscat.mallplus.db.ABBaseUnits;


@Component("${BuildDaoBean.className}SearchUnits")
public class ${BuildDaoBean.className}SearchUnits  extends ABBaseUnits {

@Autowired
private ${BuildDaoBean.className}BaseMapper  i${BuildDaoBean.className}BaseMapper;

   @SuppressWarnings("deprecation")
	private Page<${BuildDaoBean.className}>  createPage(OptType optType,
		                            ${BuildDaoBean.className}SearchBean searchBean,CommSearchBean commSearchBean){
		Page<${BuildDaoBean.className}> page = new Page<${BuildDaoBean.className}>(commSearchBean.getPageNum(),
				commSearchBean.getPageSize());
		if(StringUtils.isNotEmpty(commSearchBean.getDir())) {
			String sort =StringUtils.isNotEmpty(commSearchBean.getSort())?"desc":commSearchBean.getSort();
			switch (sort.toLowerCase()) {
			case "asc":
				page.setAsc(commSearchBean.getDir());
				break;
			case "desc":
				page.setDesc(commSearchBean.getDir());
				break;
			default:
				break;
			}
		}
		return page;
	}

    public SelectPage<${BuildDaoBean.className}> search(OptType optType,
		                            ${BuildDaoBean.className}SearchBean searchBean,CommSearchBean commSearchBean) throws SystemOptServiceException {
       
        Page<${BuildDaoBean.className}> page =createPage(optType, searchBean, commSearchBean);
		 List<${BuildDaoBean.className}> result= list(page, searchBean, commSearchBean);
		 SelectPage<${BuildDaoBean.className}> selectPage = new SelectPage<${BuildDaoBean.className}>();
		selectPage.setTotal(page.getTotal());
		selectPage.setSize(page.getSize());
		selectPage.setCurrent(page.getCurrent());
		selectPage.setRecords(result);
		return selectPage;

    }
	
	
	    public List<${BuildDaoBean.className}> list(OptType optType,
		                            ${BuildDaoBean.className}SearchBean searchBean,CommSearchBean commSearchBean) throws SystemOptServiceException {
       
       Page<${BuildDaoBean.className}> page =createPage(optType, searchBean, commSearchBean);
       
        List<${BuildDaoBean.className}> result = list(page,searchBean, commSearchBean);

		return result;

    }
	
    private List<${BuildDaoBean.className}> list(Page<${BuildDaoBean.className}> page ,${BuildDaoBean.className}SearchBean searchBean, CommSearchBean commSearchBean) throws SystemOptServiceException {

		return i${BuildDaoBean.className}BaseMapper.search${BuildDaoBean.className}Selective(page,searchBean,commSearchBean);

	}
	
	
	

    public ${BuildDaoBean.className} searchSingle(OptType optType, ${BuildDaoBean.className}SearchBean searchBean) throws SystemOptServiceException {
        CommSearchBean commSearchBean = new CommSearchBean();
		commSearchBean.setPageNum(1);
		commSearchBean.setPageSize(1);
		Page<${BuildDaoBean.className}> page =createPage(optType, searchBean, commSearchBean);
		List<${BuildDaoBean.className}>  result = list(page, searchBean,commSearchBean);
		if(result.size()>1)throw new SystemOptServiceException("searcn Single Bean  error  resut > 1 ");
	    return result.size() ==0 ? null:result.get(0);
				
	}
	

}
